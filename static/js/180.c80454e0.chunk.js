"use strict";(self.webpackChunkbooks_shop=self.webpackChunkbooks_shop||[]).push([[180],{1374:(e,t,r)=>{function s(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}r.d(t,{A:()=>b});var a=0;function n(e){return"__private_"+a+++"_"+e}class i{constructor(){this.message=""}setError(e){this.message=e}reset(){this.message=""}validate(e){throw new Error("validate() must be implemented in subclass")}}class o extends i{validate(e){let t=typeof e;return this.reset(),null===e||void 0===e?(this.setError("The value is required!"),!1):"string"!==t||""!==e.trim()||(this.setError("The value is required!"),!1)}}class l extends i{validate(e){return this.reset(),e.length<2?(this.setError("The name is too short!"),!1):!(e.length>10)||(this.setError("The name is too long!"),!1)}}class c extends i{validate(e){return this.reset(),e.length<6?(this.setError("Password must be at least 6 characters long!"),!1):/[A-Z]/.test(e)?!!/[0-9]/.test(e)||(this.setError("Password must contain at least one number!"),!1):(this.setError("Password must contain at least one uppercase letter!"),!1)}}class u extends i{validate(e){return this.reset(),!!/^[^\s@]+@[^\s@]+\.[a-zA-Z]{2,}$/.test(e)||(this.setError("Incorrect email!"),!1)}}class d extends i{validate(e){return this.reset(),!!/^\+?\d{10,15}$/.test(e)||(this.setError("Incorrect phone number!"),!1)}}class h extends i{constructor(){super(...arguments),this.MAX_SIZE=1048576,this.ALLOWED_TYPES=["image/jpeg","image/png","image/webp"]}validate(e){return this.reset(),this.ALLOWED_TYPES.includes(e.type)?!(e.size>this.MAX_SIZE)||(this.setError("The file cannot be larger than 1MB."),!1):(this.setError("Allowed formats: JPG, PNG, WEBP."),!1)}}class m extends i{validate(e){let{newPassword:t,confirm:r}=e;return this.reset(),t===r||(this.setError("New passwords do not match!"),!1)}}class v extends i{validate(e){let{totalCount:t,maxTotalCount:r}=e;return this.reset(),"number"!==typeof t||"number"!==typeof r?(this.setError("Invalid quantity data!"),!1):t<=0?(this.setError("The value is not valid!"),!1):!(t>r)||(this.setError("Only ".concat(r," available!")),!1)}}var f=n("validators");class g{static initialize(){s(g,f)[f]={required:new o,name:new l,password:new c,email:new u,phoneNumber:new d,avatar:new h,passwordEquality:new m,orderQuantity:new v},g.initialize=()=>{}}static select(e){const t=s(g,f)[f][e];if(!t)throw new Error("No validator found: "+e);return t}}Object.defineProperty(g,f,{writable:!0,value:{}});var p=n("config"),y=n("validateObj"),w=n("validateValue");class b{constructor(e){Object.defineProperty(this,w,{value:E}),Object.defineProperty(this,y,{value:x}),Object.defineProperty(this,p,{writable:!0,value:void 0});const t="string"===typeof e||Array.isArray(e)||"object"===typeof e;if(!e)throw new Error("No validation config provided!");if(!t)throw new Error("Config must be string, array, or object!");s(this,p)[p]=e,"string"===typeof e||Array.isArray(e)?this.validate=s(this,w)[w]:this.validate=s(this,y)[y],g.initialize()}}function x(e){if(!e||"object"!==typeof e)throw new Error("Validation failed: data is missing or invalid.");const t={},r=Object.keys(s(this,p)[p]);for(const a of r){let r=s(this,p)[p][a];if(r){"string"===typeof r&&(r=[r]);for(const s of r){const r=g.select(s);if(!r.validate(e[a])){t[a]=r.message;break}}}}return{valid:0===Object.keys(t).length,errors:t}}function E(e){let t="",r=!0,a=s(this,p)[p];"string"===typeof a&&(a=[a]);for(const s of a){const a=g.select(s),n=a.validate(e);if(!n){t=a.message,r=n;break}}return{valid:r,error:t}}},1801:(e,t,r)=>{r.d(t,{A:()=>a});var s=r(5043);const a=function(e){const[t,r]=(0,s.useState)(e.default);return(0,s.useEffect)(()=>{let t;const s=()=>{clearTimeout(t),t=setTimeout(()=>{for(const t in e){if("default"!==t&&window.innerWidth<=t){r(e[t]);break}if("default"===t){r(e[t]);break}}},500)};return s(),window.addEventListener("resize",s),()=>{clearTimeout(t),window.removeEventListener("resize",s)}},[e]),t}},2138:(e,t,r)=>{r.d(t,{A:()=>i,u:()=>n});var s=r(1374);function a(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];const n=Array.isArray(r[0])?r[0]:r;return new s.A(n).validate(e)}function n(e){return a(e,"required","avatar")}function i(e,t){return a({totalCount:e,maxTotalCount:t},"orderQuantity")}},2286:(e,t,r)=>{r.d(t,{A:()=>a});var s=r(579);const a=function(e){let{className:t,message:r,type:a}=e,n=a?"".concat(t," message-").concat(a):t;return n="message"===t?n:"message "+n,(0,s.jsx)("p",{className:n,role:"alert",children:r})}},5232:(e,t,r)=>{r.d(t,{S:()=>a});var s=r(5043);function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const[r,a]=(0,s.useState)(e),n=(0,s.useRef)(null),i=(0,s.useRef)(!0);(0,s.useEffect)(()=>(i.current=!0,()=>{i.current=!1,n.current&&clearTimeout(n.current)}),[]);const o=(0,s.useCallback)((r,s)=>{const o=void 0!==s?s:t;a(r),n.current&&clearTimeout(n.current),null!==o&&void 0!==o&&(n.current=setTimeout(()=>{i.current&&a(e),n.current=null},o))},[t,e]);return{value:r,showValue:o,clearValue:(0,s.useCallback)(()=>{n.current&&clearTimeout(n.current),n.current=null,a(e)},[e])}}},5682:(e,t,r)=>{r.d(t,{_:()=>n});var s=r(5043),a=r(5232);function n(e){const t=(0,s.useMemo)(()=>({text:"",type:""}),[]),{value:r,showValue:n,clearValue:i}=(0,a.S)(t,e),o=(0,s.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n(r=>r.text===e&&r.type===t?r:{text:e,type:t},arguments.length>2?arguments[2]:void 0)},[n]);return{message:r,showMessage:o,clearMessage:i}}},6037:(e,t,r)=>{r.d(t,{A:()=>h});var s=r(5043),a=r(5682),n=r(5767),i=r(8396),o=r(321),l=r(2286),c=r(5536),u=r(2138),d=r(579);const h=function(e){let{className:t="",size:r="16rem"}=e;const{avatar:h,loading:m,error:v,updateAvatar:f,deleteAvatar:g}=(0,n.r)(),{message:p,showMessage:y,clearMessage:w}=(0,a._)(1e4),b=(0,s.useRef)(null),x=(0,s.useRef)(null);(0,s.useEffect)(()=>{v&&y(v.message,"error")},[v,y]);const E=()=>{m||b.current.click()},A=()=>{w(),g()};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:t,style:{width:r},children:[(0,d.jsxs)("div",{className:"avatar-img-container fancy-background",style:{width:"100%",height:r},title:"Click to change avatar","aria-label":"Change avatar",role:"button","aria-pressed":!!h,tabIndex:0,onClick:E,onKeyDown:e=>{m||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),E())},ref:x,children:[(0,d.jsx)(i.A,{src:h||c,style:{lineHeight:r},alt:"User Avatar"}),m?(0,d.jsx)("div",{className:"avatar-overlay",children:(0,d.jsx)(o.A,{type:"small"})}):(0,d.jsxs)("div",{className:"avatar-overlay",children:["\ud83d\udcf7",h&&(0,d.jsx)("button",{type:"button",className:"btn-text btn-effect-3d","aria-label":"Remove avatar",onClick:e=>{e.stopPropagation(),A()},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),A(),x.current.focus())},children:"\xd7"})]})]}),(null===p||void 0===p?void 0:p.text)&&(0,d.jsx)(l.A,{className:"message",message:p.text,type:p.type})]}),(0,d.jsx)("input",{type:"file",accept:"image/jpeg,image/png,image/webp",ref:b,style:{display:"none"},onChange:async e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!r)return;w();let{valid:s,error:a}=(0,u.u)(r);if(!s)return void y(a,"error");const n=await function(e){return new Promise((t,r)=>{const s=new FileReader;s.onload=()=>t(s.result),s.onerror=r,s.readAsDataURL(e)})}(r);f(n),x.current.blur()}})]})}},8180:(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var s=r(3721),a=r(1801),n=r(4528),i=r(6037),o=r(579);const l=function(){console.log("SignIn render");const{userName:e,setUserName:t,setIsLoggedIn:r}=(0,n.A)(),l=(0,s.Zp)(),c=(0,a.A)({320:"12.5rem",480:"14rem",default:"10rem"});function u(e){return e.length>=4&&e.length<=16}function d(t){t.preventDefault(),u(e)&&(r(!0),l("/shop"))}return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"signin-container",children:[(0,o.jsx)(i.A,{className:"avatar",size:c}),(0,o.jsxs)("form",{className:"fancy-background",action:"#",method:"post",onSubmit:e=>{d(e)},children:[(0,o.jsx)("label",{htmlFor:"user-name",children:"User name"}),(0,o.jsx)("input",{type:"text",name:"userName",id:"user-name",placeholder:"Type your name",required:!0,value:e,onChange:e=>{t(e.target.value)}}),(0,o.jsx)("button",{type:"submit",className:"btn-effect-3d",disabled:!u(e),children:"Sign-in"})]})]})})}},8396:(e,t,r)=>{r.d(t,{A:()=>l});var s=r(2555),a=r(3986),n=r(5043),i=r(579);const o=["src","alt","className"];const l=function(e){let{src:t,alt:r,className:l}=e,c=(0,a.A)(e,o);const[u,d]=(0,n.useState)(!1),[h,m]=(0,n.useState)(!1);return h?(0,i.jsx)("div",{className:"on-error-fallback flex",children:r}):(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("img",(0,s.A)((0,s.A)({src:t,alt:r},c),{},{className:"".concat(l," lazy-img ").concat(u?"loaded":""),onLoad:()=>{d(!0)},onError:()=>{m(!0)}}))})}}}]);
//# sourceMappingURL=180.c80454e0.chunk.js.map