"use strict";(self.webpackChunkbooks_shop=self.webpackChunkbooks_shop||[]).push([[216],{647:(e,t,s)=>{e.exports=s.p+"static/media/imgNotFound.298b98203c3825c61303.png"},1374:(e,t,s)=>{function r(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}s.d(t,{A:()=>y});var a=0;function n(e){return"__private_"+a+++"_"+e}class i{constructor(){this.message=""}setError(e){this.message=e}reset(){this.message=""}validate(e){throw new Error("validate() must be implemented in subclass")}}class o extends i{validate(e){let t=typeof e;return this.reset(),null===e||void 0===e?(this.setError("The value is required!"),!1):"string"!==t||""!==e.trim()||(this.setError("The value is required!"),!1)}}class l extends i{validate(e){return this.reset(),e.length<2?(this.setError("The name is too short!"),!1):!(e.length>10)||(this.setError("The name is too long!"),!1)}}class c extends i{validate(e){return this.reset(),e.length<6?(this.setError("Password must be at least 6 characters long!"),!1):/[A-Z]/.test(e)?!!/[0-9]/.test(e)||(this.setError("Password must contain at least one number!"),!1):(this.setError("Password must contain at least one uppercase letter!"),!1)}}class u extends i{validate(e){return this.reset(),!!/^[^\s@]+@[^\s@]+\.[a-zA-Z]{2,}$/.test(e)||(this.setError("Incorrect email!"),!1)}}class d extends i{validate(e){return this.reset(),!!/^\+?\d{10,15}$/.test(e)||(this.setError("Incorrect phone number!"),!1)}}class h extends i{constructor(){super(...arguments),this.MAX_SIZE=1048576,this.ALLOWED_TYPES=["image/jpeg","image/png","image/webp"]}validate(e){return this.reset(),this.ALLOWED_TYPES.includes(e.type)?!(e.size>this.MAX_SIZE)||(this.setError("The file cannot be larger than 1MB."),!1):(this.setError("Allowed formats: JPG, PNG, WEBP."),!1)}}class m extends i{validate(e){let{newPassword:t,confirm:s}=e;return this.reset(),t===s||(this.setError("New passwords do not match!"),!1)}}class f extends i{validate(e){let{totalCount:t,maxTotalCount:s}=e;return this.reset(),"number"!==typeof t||"number"!==typeof s?(this.setError("Invalid quantity data!"),!1):t<=0?(this.setError("The value is not valid!"),!1):!(t>s)||(this.setError(`Only ${s} available!`),!1)}}var p=n("validators");class v{static initialize(){r(v,p)[p]={required:new o,name:new l,password:new c,email:new u,phoneNumber:new d,avatar:new h,passwordEquality:new m,orderQuantity:new f},v.initialize=()=>{}}static select(e){const t=r(v,p)[p][e];if(!t)throw new Error("No validator found: "+e);return t}}Object.defineProperty(v,p,{writable:!0,value:{}});var b=n("config"),g=n("validateObj"),x=n("validateValue");class y{constructor(e){Object.defineProperty(this,x,{value:w}),Object.defineProperty(this,g,{value:j}),Object.defineProperty(this,b,{writable:!0,value:void 0});const t="string"===typeof e||Array.isArray(e)||"object"===typeof e;if(!e)throw new Error("No validation config provided!");if(!t)throw new Error("Config must be string, array, or object!");r(this,b)[b]=e,"string"===typeof e||Array.isArray(e)?this.validate=r(this,x)[x]:this.validate=r(this,g)[g],v.initialize()}}function j(e){if(!e||"object"!==typeof e)throw new Error("Validation failed: data is missing or invalid.");const t={},s=Object.keys(r(this,b)[b]);for(const a of s){let s=r(this,b)[b][a];if(s){"string"===typeof s&&(s=[s]);for(const r of s){const s=v.select(r);if(!s.validate(e[a])){t[a]=s.message;break}}}}return{valid:0===Object.keys(t).length,errors:t}}function w(e){let t="",s=!0,a=r(this,b)[b];"string"===typeof a&&(a=[a]);for(const r of a){const a=v.select(r),n=a.validate(e);if(!n){t=a.message,s=n;break}}return{valid:s,error:t}}},2138:(e,t,s)=>{s.d(t,{A:()=>i,u:()=>n});var r=s(1374);function a(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];const n=Array.isArray(s[0])?s[0]:s;return new r.A(n).validate(e)}function n(e){return a(e,"required","avatar")}function i(e,t){return a({totalCount:e,maxTotalCount:t},"orderQuantity")}},2286:(e,t,s)=>{s.d(t,{A:()=>a});var r=s(579);const a=function(e){let{className:t,message:s,type:a}=e,n=a?`${t} message-${a}`:t;return n="message"===t?n:"message "+n,(0,r.jsx)("p",{className:n,role:"alert",children:s})}},4958:(e,t,s)=>{s.d(t,{A:()=>a});var r=s(5043);function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;const[s,a]=(0,r.useState)(e);return(0,r.useEffect)(()=>{const s=setTimeout(()=>{a(e)},t);return()=>clearTimeout(s)},[e,t]),s}},5232:(e,t,s)=>{s.d(t,{S:()=>a});var r=s(5043);function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const[s,a]=(0,r.useState)(e),n=(0,r.useRef)(null),i=(0,r.useRef)(!0);(0,r.useEffect)(()=>(i.current=!0,()=>{i.current=!1,n.current&&clearTimeout(n.current)}),[]);const o=(0,r.useCallback)((s,r)=>{const o=void 0!==r?r:t;a(s),n.current&&clearTimeout(n.current),null!==o&&void 0!==o&&(n.current=setTimeout(()=>{i.current&&a(e),n.current=null},o))},[t,e]);return{value:s,showValue:o,clearValue:(0,r.useCallback)(()=>{n.current&&clearTimeout(n.current),n.current=null,a(e)},[e])}}},5682:(e,t,s)=>{s.d(t,{_:()=>n});var r=s(5043),a=s(5232);function n(e){const t=(0,r.useMemo)(()=>({text:"",type:""}),[]),{value:s,showValue:n,clearValue:i}=(0,a.S)(t,e),o=(0,r.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n(s=>s.text===e&&s.type===t?s:{text:e,type:t},arguments.length>2?arguments[2]:void 0)},[n]);return{message:s,showMessage:o,clearMessage:i}}},8216:(e,t,s)=>{s.r(t),s.d(t,{default:()=>x});var r=s(5043),a=s(1228),n=s(3721),i=s(4958),o=s(5682),l=s(2138),c=s(2286),u=s(321),d=s(8396),h=s(647),m=s(579);const f=(0,r.memo)(function(e){let{productId:t,quantity:s,book:{price:f,title:p,image:v,amount:b}}=e;const{changeQuantity:g,removeFromCart:x,loading:y,error:j}=(0,a._)(),w=(null===j||void 0===j?void 0:j.message)||"",[E,N]=(0,r.useState)(s),k=(f*s).toFixed(2),A=(0,i.A)(E,1e3),{valid:C,error:T}=(0,l.A)(A,b),{message:_,showMessage:P,clearMessage:q}=(0,o._)(1e4),S=T||w,$=!!S;return(0,r.useEffect)(()=>{$?P(S,"error"):q()},[$,S,P,q]),(0,r.useEffect)(()=>{A!==s&&C&&g(t,A)},[A,s,C,t,g]),(0,m.jsxs)("div",{className:"cart-item flex",children:[(0,m.jsx)(n.N_,{to:`/specific-book/${t}`,className:"img-container",children:(0,m.jsx)(d.A,{className:"book-image",src:v||h,alt:"Book image"})}),(0,m.jsxs)("div",{className:"item-info flex",children:[(0,m.jsx)("div",{children:(0,m.jsx)(n.N_,{to:`/specific-book/${t}`,children:p})}),(null===_||void 0===_?void 0:_.text)&&(0,m.jsx)(c.A,{className:"message",message:_.text,type:_.type}),(0,m.jsxs)("div",{className:"price-quantity-container flex",children:[(0,m.jsxs)("div",{className:"price-block",children:[(0,m.jsxs)("p",{children:["Price: ",(0,m.jsxs)("span",{children:[f,"$"]})]}),(0,m.jsxs)("p",{children:["Quantity: ",(0,m.jsx)("span",{children:s})]}),(0,m.jsxs)("p",{children:["Total: ",(0,m.jsxs)("span",{children:[k,"$"]})]})]}),(0,m.jsxs)("div",{className:"quantity-block",children:[(0,m.jsx)("button",{type:"button","aria-label":"Decrease count of books",className:"btn-minus btn-effect-3d btn-circle",onClick:function(){N(e=>e-1)},disabled:y,children:"-"}),(0,m.jsx)("input",{className:C?"input-quantity":"input-quantity invalid-field",type:"number",required:!0,step:"1",min:"1",max:"1000",value:0===E?"":E,onChange:function(e){let t=Number(e.target.value);N(t)}}),(0,m.jsx)("button",{type:"button","aria-label":"Increase count of books",className:"btn-plus btn-effect-3d btn-circle",onClick:function(){N(e=>e+1)},disabled:y,children:"+"})]})]})]}),(0,m.jsx)("button",{type:"button",className:"btn-remove btn-text btn-effect-3d",title:"Remove item","aria-label":"Remove from cart",disabled:y,onClick:()=>{x(t)},children:"\xd7"}),y&&(0,m.jsx)(u.A,{type:"local"})]})}),p=(0,r.memo)(function(){const{cart:e}=(0,a._)();return(0,m.jsx)("section",{className:"cart-items-list",children:e.map(e=>(0,m.jsx)(f,{...e},e.productId))})}),v=p;var b=s(9760);const g=(0,r.memo)(function(){return(0,m.jsxs)("div",{className:"empty-cart-container fancy-background",children:[(0,m.jsx)("h2",{children:"Cart is empty!"}),(0,m.jsx)("img",{src:b.A,alt:"Empty cart",loading:"lazy"}),(0,m.jsx)(n.N_,{to:"/shop",className:"a-like-btn btn-effect-press",children:"Go to Shop"})]})}),x=(0,r.memo)(function(){const{totalPrice:e,totalCount:t,clearCart:s,loading:r}=(0,a._)();return 0===t?(0,m.jsx)(g,{}):(0,m.jsxs)("div",{className:"cart-container fancy-background",children:[(0,m.jsx)("button",{type:"button",className:"btn-clear-cart btn-effect-press",onClick:s,disabled:r,children:"Clear cart"}),(0,m.jsx)(v,{}),(0,m.jsxs)("p",{className:"total-price",children:["Total price: ",(0,m.jsxs)("span",{children:[e.toFixed(2),"$"]})]})]})})},8396:(e,t,s)=>{s.d(t,{A:()=>n});var r=s(5043),a=s(579);const n=function(e){let{src:t,alt:s,className:n,...i}=e;const[o,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1);return c?(0,a.jsx)("div",{className:"on-error-fallback flex",children:s}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("img",{src:t,alt:s,...i,className:`${n} lazy-img ${o?"loaded":""}`,onLoad:()=>{l(!0)},onError:()=>{u(!0)}})})}}}]);
//# sourceMappingURL=216.5e207254.chunk.js.map