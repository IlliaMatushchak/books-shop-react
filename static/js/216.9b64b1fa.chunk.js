"use strict";(self.webpackChunkbooks_shop=self.webpackChunkbooks_shop||[]).push([[216],{647:(e,t,s)=>{e.exports=s.p+"static/media/imgNotFound.298b98203c3825c61303.png"},1374:(e,t,s)=>{function r(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}s.d(t,{A:()=>y});var a=0;function n(e){return"__private_"+a+++"_"+e}class i{constructor(){this.message=""}setError(e){this.message=e}reset(){this.message=""}validate(e){throw new Error("validate() must be implemented in subclass")}}class o extends i{validate(e){let t=typeof e;return this.reset(),null===e||void 0===e?(this.setError("The value is required!"),!1):"string"!==t||""!==e.trim()||(this.setError("The value is required!"),!1)}}class c extends i{validate(e){return this.reset(),e.length<2?(this.setError("The name is too short!"),!1):!(e.length>10)||(this.setError("The name is too long!"),!1)}}class l extends i{validate(e){return this.reset(),e.length<6?(this.setError("Password must be at least 6 characters long!"),!1):/[A-Z]/.test(e)?!!/[0-9]/.test(e)||(this.setError("Password must contain at least one number!"),!1):(this.setError("Password must contain at least one uppercase letter!"),!1)}}class u extends i{validate(e){return this.reset(),!!/^[^\s@]+@[^\s@]+\.[a-zA-Z]{2,}$/.test(e)||(this.setError("Incorrect email!"),!1)}}class d extends i{validate(e){return this.reset(),!!/^\+?\d{10,15}$/.test(e)||(this.setError("Incorrect phone number!"),!1)}}class h extends i{constructor(){super(...arguments),this.MAX_SIZE=1048576,this.ALLOWED_TYPES=["image/jpeg","image/png","image/webp"]}validate(e){return this.reset(),this.ALLOWED_TYPES.includes(e.type)?!(e.size>this.MAX_SIZE)||(this.setError("The file cannot be larger than 1MB."),!1):(this.setError("Allowed formats: JPG, PNG, WEBP."),!1)}}class m extends i{validate(e){let{newPassword:t,confirm:s}=e;return this.reset(),t===s||(this.setError("New passwords do not match!"),!1)}}class f extends i{validate(e){let{totalCount:t,maxTotalCount:s}=e;return this.reset(),"number"!==typeof t||"number"!==typeof s?(this.setError("Invalid quantity data!"),!1):t<=0?(this.setError("The value is not valid!"),!1):!(t>s)||(this.setError("Only ".concat(s," available!")),!1)}}var p=n("validators");class v{static initialize(){r(v,p)[p]={required:new o,name:new c,password:new l,email:new u,phoneNumber:new d,avatar:new h,passwordEquality:new m,orderQuantity:new f},v.initialize=()=>{}}static select(e){const t=r(v,p)[p][e];if(!t)throw new Error("No validator found: "+e);return t}}Object.defineProperty(v,p,{writable:!0,value:{}});var b=n("config"),g=n("validateObj"),x=n("validateValue");class y{constructor(e){Object.defineProperty(this,x,{value:w}),Object.defineProperty(this,g,{value:j}),Object.defineProperty(this,b,{writable:!0,value:void 0});const t="string"===typeof e||Array.isArray(e)||"object"===typeof e;if(!e)throw new Error("No validation config provided!");if(!t)throw new Error("Config must be string, array, or object!");r(this,b)[b]=e,"string"===typeof e||Array.isArray(e)?this.validate=r(this,x)[x]:this.validate=r(this,g)[g],v.initialize()}}function j(e){if(!e||"object"!==typeof e)throw new Error("Validation failed: data is missing or invalid.");const t={},s=Object.keys(r(this,b)[b]);for(const a of s){let s=r(this,b)[b][a];if(s){"string"===typeof s&&(s=[s]);for(const r of s){const s=v.select(r);if(!s.validate(e[a])){t[a]=s.message;break}}}}return{valid:0===Object.keys(t).length,errors:t}}function w(e){let t="",s=!0,a=r(this,b)[b];"string"===typeof a&&(a=[a]);for(const r of a){const a=v.select(r),n=a.validate(e);if(!n){t=a.message,s=n;break}}return{valid:s,error:t}}},2138:(e,t,s)=>{s.d(t,{A:()=>i,u:()=>n});var r=s(1374);function a(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];const n=Array.isArray(s[0])?s[0]:s;return new r.A(n).validate(e)}function n(e){return a(e,"required","avatar")}function i(e,t){return a({totalCount:e,maxTotalCount:t},"orderQuantity")}},2286:(e,t,s)=>{s.d(t,{A:()=>a});var r=s(579);const a=function(e){let{className:t,message:s,type:a}=e,n=a?"".concat(t," message-").concat(a):t;return n="message"===t?n:"message "+n,(0,r.jsx)("p",{className:n,role:"alert",children:s})}},4958:(e,t,s)=>{s.d(t,{A:()=>a});var r=s(5043);function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;const[s,a]=(0,r.useState)(e);return(0,r.useEffect)(()=>{const s=setTimeout(()=>{a(e)},t);return()=>clearTimeout(s)},[e,t]),s}},5232:(e,t,s)=>{s.d(t,{S:()=>a});var r=s(5043);function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const[s,a]=(0,r.useState)(e),n=(0,r.useRef)(null),i=(0,r.useRef)(!0);(0,r.useEffect)(()=>(i.current=!0,()=>{i.current=!1,n.current&&clearTimeout(n.current)}),[]);const o=(0,r.useCallback)((s,r)=>{const o=void 0!==r?r:t;a(s),n.current&&clearTimeout(n.current),null!==o&&void 0!==o&&(n.current=setTimeout(()=>{i.current&&a(e),n.current=null},o))},[t,e]);return{value:s,showValue:o,clearValue:(0,r.useCallback)(()=>{n.current&&clearTimeout(n.current),n.current=null,a(e)},[e])}}},5682:(e,t,s)=>{s.d(t,{_:()=>n});var r=s(5043),a=s(5232);function n(e){const t=(0,r.useMemo)(()=>({text:"",type:""}),[]),{value:s,showValue:n,clearValue:i}=(0,a.S)(t,e),o=(0,r.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n(s=>s.text===e&&s.type===t?s:{text:e,type:t},arguments.length>2?arguments[2]:void 0)},[n]);return{message:s,showMessage:o,clearMessage:i}}},8216:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var r=s(5043),a=s(1228),n=s(2555),i=s(3721),o=s(4958),c=s(5682),l=s(2138),u=s(2286),d=s(321),h=s(8396),m=s(647),f=s(579);const p=(0,r.memo)(function(e){let{productId:t,quantity:s,book:{price:n,title:p,image:v,amount:b}}=e;const{changeQuantity:g,removeFromCart:x,loading:y,error:j}=(0,a._)(),w=(null===j||void 0===j?void 0:j.message)||"",[E,N]=(0,r.useState)(s),k=(n*s).toFixed(2),A=(0,o.A)(E,1e3),{valid:C,error:T}=(0,l.A)(A,b),{message:_,showMessage:P,clearMessage:q}=(0,c._)(1e4),S=T||w,O=!!S;return(0,r.useEffect)(()=>{O?P(S,"error"):q()},[O,S,P,q]),(0,r.useEffect)(()=>{A!==s&&C&&g(t,A)},[A,s,C,t,g]),(0,f.jsxs)("div",{className:"cart-item flex",children:[(0,f.jsx)(i.N_,{to:"/specific-book/".concat(t),className:"img-container",children:(0,f.jsx)(h.A,{className:"book-image",src:v||m,alt:"Book image"})}),(0,f.jsxs)("div",{className:"item-info flex",children:[(0,f.jsx)("div",{children:(0,f.jsx)(i.N_,{to:"/specific-book/".concat(t),children:p})}),(null===_||void 0===_?void 0:_.text)&&(0,f.jsx)(u.A,{className:"message",message:_.text,type:_.type}),(0,f.jsxs)("div",{className:"price-quantity-container flex",children:[(0,f.jsxs)("div",{className:"price-block",children:[(0,f.jsxs)("p",{children:["Price: ",(0,f.jsxs)("span",{children:[n,"$"]})]}),(0,f.jsxs)("p",{children:["Quantity: ",(0,f.jsx)("span",{children:s})]}),(0,f.jsxs)("p",{children:["Total: ",(0,f.jsxs)("span",{children:[k,"$"]})]})]}),(0,f.jsxs)("div",{className:"quantity-block",children:[(0,f.jsx)("button",{type:"button","aria-label":"Decrease count of books",className:"btn-minus btn-effect-3d btn-circle",onClick:function(){N(e=>e-1)},disabled:y,children:"-"}),(0,f.jsx)("input",{className:C?"input-quantity":"input-quantity invalid-field",type:"number",required:!0,step:"1",min:"1",max:"1000",value:0===E?"":E,onChange:function(e){let t=Number(e.target.value);N(t)}}),(0,f.jsx)("button",{type:"button","aria-label":"Increase count of books",className:"btn-plus btn-effect-3d btn-circle",onClick:function(){N(e=>e+1)},disabled:y,children:"+"})]})]})]}),(0,f.jsx)("button",{type:"button",className:"btn-remove btn-text btn-effect-3d",title:"Remove item","aria-label":"Remove from cart",disabled:y,onClick:()=>{x(t)},children:"\xd7"}),y&&(0,f.jsx)(d.A,{type:"local"})]})}),v=(0,r.memo)(function(){const{cart:e}=(0,a._)();return(0,f.jsx)("section",{className:"cart-items-list",children:e.map(e=>(0,f.jsx)(p,(0,n.A)({},e),e.productId))})}),b=v;var g=s(9760);const x=(0,r.memo)(function(){return(0,f.jsxs)("div",{className:"empty-cart-container fancy-background",children:[(0,f.jsx)("h2",{children:"Cart is empty!"}),(0,f.jsx)("img",{src:g.A,alt:"Empty cart",loading:"lazy"}),(0,f.jsx)(i.N_,{to:"/shop",className:"a-like-btn btn-effect-press",children:"Go to Shop"})]})}),y=(0,r.memo)(function(){const{totalPrice:e,totalCount:t,clearCart:s,loading:r}=(0,a._)();return 0===t?(0,f.jsx)(x,{}):(0,f.jsxs)("div",{className:"cart-container fancy-background",children:[(0,f.jsx)("button",{type:"button",className:"btn-clear-cart btn-effect-press",onClick:s,disabled:r,children:"Clear cart"}),(0,f.jsx)(b,{}),(0,f.jsxs)("p",{className:"total-price",children:["Total price: ",(0,f.jsxs)("span",{children:[e.toFixed(2),"$"]})]})]})})},8396:(e,t,s)=>{s.d(t,{A:()=>c});var r=s(2555),a=s(3986),n=s(5043),i=s(579);const o=["src","alt","className"];const c=function(e){let{src:t,alt:s,className:c}=e,l=(0,a.A)(e,o);const[u,d]=(0,n.useState)(!1),[h,m]=(0,n.useState)(!1);return h?(0,i.jsx)("div",{className:"on-error-fallback flex",children:s}):(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("img",(0,r.A)((0,r.A)({src:t,alt:s},l),{},{className:"".concat(c," lazy-img ").concat(u?"loaded":""),onLoad:()=>{d(!0)},onError:()=>{m(!0)}}))})}}}]);
//# sourceMappingURL=216.9b64b1fa.chunk.js.map