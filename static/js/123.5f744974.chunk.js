"use strict";(self.webpackChunkbooks_shop=self.webpackChunkbooks_shop||[]).push([[123],{1374:(e,r,s)=>{function t(e,r){if(!{}.hasOwnProperty.call(e,r))throw new TypeError("attempted to use private field on non-instance");return e}s.d(r,{A:()=>y});var a=0;function n(e){return"__private_"+a+++"_"+e}class o{constructor(){this.message=""}setError(e){this.message=e}reset(){this.message=""}validate(e){throw new Error("validate() must be implemented in subclass")}}class i extends o{validate(e){let r=typeof e;return this.reset(),null===e||void 0===e?(this.setError("The value is required!"),!1):"string"!==r||""!==e.trim()||(this.setError("The value is required!"),!1)}}class l extends o{validate(e){return this.reset(),e.length<2?(this.setError("The name is too short!"),!1):!(e.length>10)||(this.setError("The name is too long!"),!1)}}class u extends o{validate(e){return this.reset(),e.length<6?(this.setError("Password must be at least 6 characters long!"),!1):/[A-Z]/.test(e)?!!/[0-9]/.test(e)||(this.setError("Password must contain at least one number!"),!1):(this.setError("Password must contain at least one uppercase letter!"),!1)}}class c extends o{validate(e){return this.reset(),!!/^[^\s@]+@[^\s@]+\.[a-zA-Z]{2,}$/.test(e)||(this.setError("Incorrect email!"),!1)}}class d extends o{validate(e){return this.reset(),!!/^\+?\d{10,15}$/.test(e)||(this.setError("Incorrect phone number!"),!1)}}class h extends o{constructor(){super(...arguments),this.MAX_SIZE=1048576,this.ALLOWED_TYPES=["image/jpeg","image/png","image/webp"]}validate(e){return this.reset(),this.ALLOWED_TYPES.includes(e.type)?!(e.size>this.MAX_SIZE)||(this.setError("The file cannot be larger than 1MB."),!1):(this.setError("Allowed formats: JPG, PNG, WEBP."),!1)}}class m extends o{validate(e){let{newPassword:r,confirm:s}=e;return this.reset(),r===s||(this.setError("New passwords do not match!"),!1)}}class p extends o{validate(e){let{totalCount:r,maxTotalCount:s}=e;return this.reset(),"number"!==typeof r||"number"!==typeof s?(this.setError("Invalid quantity data!"),!1):r<=0?(this.setError("The value is not valid!"),!1):!(r>s)||(this.setError(`Only ${s} available!`),!1)}}var f=n("validators");class g{static initialize(){t(g,f)[f]={required:new i,name:new l,password:new u,email:new c,phoneNumber:new d,avatar:new h,passwordEquality:new m,orderQuantity:new p},g.initialize=()=>{}}static select(e){const r=t(g,f)[f][e];if(!r)throw new Error("No validator found: "+e);return r}}Object.defineProperty(g,f,{writable:!0,value:{}});var v=n("config"),w=n("validateObj"),b=n("validateValue");class y{constructor(e){Object.defineProperty(this,b,{value:j}),Object.defineProperty(this,w,{value:E}),Object.defineProperty(this,v,{writable:!0,value:void 0});const r="string"===typeof e||Array.isArray(e)||"object"===typeof e;if(!e)throw new Error("No validation config provided!");if(!r)throw new Error("Config must be string, array, or object!");t(this,v)[v]=e,"string"===typeof e||Array.isArray(e)?this.validate=t(this,b)[b]:this.validate=t(this,w)[w],g.initialize()}}function E(e){if(!e||"object"!==typeof e)throw new Error("Validation failed: data is missing or invalid.");const r={},s=Object.keys(t(this,v)[v]);for(const a of s){let s=t(this,v)[v][a];if(s){"string"===typeof s&&(s=[s]);for(const t of s){const s=g.select(t);if(!s.validate(e[a])){r[a]=s.message;break}}}}return{valid:0===Object.keys(r).length,errors:r}}function j(e){let r="",s=!0,a=t(this,v)[v];"string"===typeof a&&(a=[a]);for(const t of a){const a=g.select(t),n=a.validate(e);if(!n){r=a.message,s=n;break}}return{valid:s,error:r}}},2286:(e,r,s)=>{s.d(r,{A:()=>a});var t=s(579);const a=function(e){let{className:r,message:s,type:a}=e,n=a?`${r} message-${a}`:r;return n="message"===r?n:"message "+n,(0,t.jsx)("p",{className:n,role:"alert",children:s})}},5123:(e,r,s)=>{s.r(r),s.d(r,{default:()=>m});var t=s(5043),a=s(7617),n=s(4528),o=s(6476),i=s(8719),l=s(2286),u=s(321),c=s(6143),d=s(579);const h={username:"",password:""};const m=function(){const{login:e}=(0,n.A)(),[r,s]=(0,t.useState)(h),{loading:m,error:p,fetch:f}=(0,o.A)(),{messages:g,type:v,showMessages:w,clearMessages:b}=(0,a.T)(8e3);(0,t.useEffect)(()=>{p&&w({error:p.message},"error")},[p,w]);const y=e=>{const{name:r,value:t}=e.target;s(e=>({...e,[r]:t}))};return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:"login-container",children:[(0,d.jsxs)("form",{className:`fancy-background ${v||""}`,onSubmit:t=>{t.preventDefault(),b();const{valid:a,errors:n}=(0,c.eX)(r);a?f({requestFn:i.u.login,args:[r],onSuccess:r=>{e(r),s(h)}}):w(n,"error")},children:[(0,d.jsx)("h2",{children:"Login"}),(null===g||void 0===g?void 0:g.error)&&(0,d.jsx)(l.A,{message:g.error,type:v}),(0,d.jsx)("label",{htmlFor:"user-name",children:"User name"}),(0,d.jsx)("input",{id:"user-name",type:"text",name:"username",placeholder:"Type your name",value:r.username,onChange:y,required:!0,disabled:m,autoComplete:"username"}),(null===g||void 0===g?void 0:g.username)&&(0,d.jsx)(l.A,{message:g.username,type:v}),(0,d.jsx)("label",{htmlFor:"password",children:"Password"}),(0,d.jsx)("input",{id:"password",type:"password",name:"password",placeholder:"Password",value:r.password,onChange:y,required:!0,disabled:m,autoComplete:"current-password"}),(null===g||void 0===g?void 0:g.password)&&(0,d.jsx)(l.A,{message:g.password,type:v}),(0,d.jsx)("button",{type:"submit",className:"btn-effect-3d",disabled:m,children:"Login"})]}),m&&(0,d.jsx)(u.A,{type:"global"})]})})}},5232:(e,r,s)=>{s.d(r,{S:()=>a});var t=s(5043);function a(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const[s,a]=(0,t.useState)(e),n=(0,t.useRef)(null),o=(0,t.useRef)(!0);(0,t.useEffect)(()=>(o.current=!0,()=>{o.current=!1,n.current&&clearTimeout(n.current)}),[]);const i=(0,t.useCallback)((s,t)=>{const i=void 0!==t?t:r;a(s),n.current&&clearTimeout(n.current),null!==i&&void 0!==i&&(n.current=setTimeout(()=>{o.current&&a(e),n.current=null},i))},[r,e]);return{value:s,showValue:i,clearValue:(0,t.useCallback)(()=>{n.current&&clearTimeout(n.current),n.current=null,a(e)},[e])}}},6143:(e,r,s)=>{s.d(r,{C8:()=>l,E8:()=>i,eX:()=>n,yC:()=>o});var t=s(1374);function a(e,r){return new t.A(r).validate(e)}function n(e){return a(e,{username:["required","name"],password:["required","password"]})}function o(e){return a(e,{username:["required","name"],password:["required","password"],email:["required","email"],phoneNumber:["required","phoneNumber"]})}function i(e){return a(e,{email:["required","email"],phoneNumber:["required","phoneNumber"]})}function l(e){let{newPassword:r,confirm:s}=e;return a({newPassword:r,confirm:{newPassword:r,confirm:s}},{newPassword:["required","password"],confirm:"passwordEquality"})}},7617:(e,r,s)=>{s.d(r,{T:()=>n});var t=s(5043),a=s(5232);function n(e){const r=(0,t.useMemo)(()=>({messages:{},type:""}),[]),{value:s,showValue:n,clearValue:o}=(0,a.S)(r,e),i=(0,t.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n(s=>s.type===r&&s.messages===e?s:{messages:e,type:r},arguments.length>2?arguments[2]:void 0)},[n]);return{messages:s.messages,type:s.type,showMessages:i,clearMessages:o}}},8719:(e,r,s)=>{s.d(r,{u:()=>n});var t=s(8248);const a="/auth",n={async register(e,r){const s=await((e,r)=>t.A.post(a+"/register",e,{signal:r}))(e,r);return s.data},async login(e,r){const s=await((e,r)=>t.A.post(a+"/login",e,{signal:r}))(e,r);return s.data}}}}]);
//# sourceMappingURL=123.5f744974.chunk.js.map